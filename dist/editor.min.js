!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AdvancedTextEditor=t():e.AdvancedTextEditor=t()}(this,()=>(()=>{"use strict";var e={71:(e,t,n)=>{function o(e){const t=prompt("Enter code:");if(null!==t){const o=`<pre><code>${n=t,n.replace(/[&<>"]|'/g,function(e){return{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"}[e]||e})}</code></pre>`;document.execCommand("insertHTML",!1,o),e.focus()}var n}function i(e){let t=document.getElementById("find-replace-dialog");t&&t.remove(),t=document.createElement("div"),t.id="find-replace-dialog",t.style.position="fixed",t.style.top="20%",t.style.left="50%",t.style.transform="translate(-50%, 0)",t.style.background="#fff",t.style.border="1px solid #ccc",t.style.padding="16px",t.style.zIndex=1e4,t.innerHTML='\n    <label>Find: <input type="text" id="find-text"></label><br><br>\n    <label>Replace: <input type="text" id="replace-text"></label><br><br>\n    <button id="find-btn">Find</button>\n    <button id="replace-btn">Replace</button>\n    <button id="replace-all-btn">Replace All</button>\n    <button id="close-find-replace">Close</button>\n    <div id="find-replace-result" style="margin-top:8px;"></div>\n  ',document.body.appendChild(t);const n=t.querySelector("#find-text"),o=t.querySelector("#replace-text"),i=t.querySelector("#find-replace-result");t.querySelector("#close-find-replace").onclick=()=>t.remove(),t.querySelector("#find-btn").onclick=()=>{const t=n.value;if(!t)return;const o=e.innerHTML,l=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");let s=0;e.innerHTML=o.replace(l,e=>(s++,`<mark>${e}</mark>`)),i.textContent=s+" matches highlighted."},t.querySelector("#replace-btn").onclick=()=>{const e=n.value,t=o.value;if(!e)return;const i=window.getSelection();if(i.rangeCount){const n=i.getRangeAt(0);n&&n.toString().toLowerCase()===e.toLowerCase()&&(n.deleteContents(),n.insertNode(document.createTextNode(t)))}},t.querySelector("#replace-all-btn").onclick=()=>{const t=n.value,l=o.value;if(!t)return;const s=e.innerHTML,r=new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gi");let d=0;e.innerHTML=s.replace(r,e=>(d++,l)),i.textContent=d+" replacements made."}}function l(e,t=!1){t?document.execCommand("insertHTML",!1,'<hr style="border-top:2px solid #888;">'):document.execCommand("insertHorizontalRule",!1,null),e.focus()}function s(e,t){if(!t&&!(t=prompt("Enter line height (e.g. 1, 1.5, 2):")))return;const n=window.getSelection();if(0===n.rangeCount||n.isCollapsed)return void(e.style.lineHeight=t);const o=n.getRangeAt(0);if(!o.collapsed){!function(e){const t=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return"SPAN"===t.tagName&&t.style.lineHeight&&e.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),n=[];let o;for(;o=t.nextNode();)n.push(o);n.forEach(t=>{if(e.intersectsNode(t)){const e=t.parentNode;for(;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}})}(o);const e=document.createElement("span");e.style.lineHeight=t;try{o.surroundContents(e)}catch(t){const n=o.extractContents();e.appendChild(n),o.insertNode(e)}}e.focus()}function r(e){const t=prompt("Enter merge field name:");t&&(document.execCommand("insertText",!1,`{{${t}}}`),e.focus())}function d(e){document.execCommand("insertHTML",!1,'<div style="page-break-after:always;"></div>'),e.focus()}function c(e,t){let n=document.getElementById("special-char-dialog");n&&n.remove(),n=document.createElement("div"),n.id="special-char-dialog",n.style.position="fixed",n.style.top="30%",n.style.left="50%",n.style.transform="translate(-50%, 0)",n.style.background="#fff",n.style.border="1px solid #ccc",n.style.padding="16px",n.style.zIndex=1e4,n.innerHTML='\n    <div style="font-size:22px;">\n      <button class="char-btn">Œ©</button>\n      <button class="char-btn">¬©</button>\n      <button class="char-btn">¬Æ</button>\n      <button class="char-btn">‚Ñ¢</button>\n      <button class="char-btn">‚úì</button>\n      <button class="char-btn">‚òÖ</button>\n      <button class="char-btn">‚ô•</button>\n      <button class="char-btn">‚ô¶</button>\n      <button class="char-btn">‚ô£</button>\n      <button class="char-btn">‚ô†</button>\n      <button class="char-btn">‚Üê</button>\n      <button class="char-btn">‚Üí</button>\n      <button class="char-btn">‚Üë</button>\n      <button class="char-btn">‚Üì</button>\n    </div>\n    <button id="close-special-char">Close</button>\n  ',document.body.appendChild(n),n.querySelectorAll(".char-btn").forEach(e=>{e.onclick=()=>{t(e.textContent),n.remove()}}),n.querySelector("#close-special-char").onclick=()=>n.remove()}function a(e){let t=document.getElementById("table-dialog");t&&t.remove(),t=document.createElement("div"),t.id="table-dialog",t.style.position="fixed",t.style.top="25%",t.style.left="50%",t.style.transform="translate(-50%, 0)",t.style.background="#fff",t.style.border="1px solid #ccc",t.style.padding="18px",t.style.zIndex=1e4,t.innerHTML='\n    <label>Rows: <input type="number" id="table-rows" value="2" min="1" style="width:40px"></label>&nbsp;\n    <label>Columns: <input type="number" id="table-cols" value="2" min="1" style="width:40px"></label><br><br>\n    <label>Border: <input type="number" id="table-border" value="1" min="0" style="width:40px"></label>&nbsp;\n    <label>Width: <input type="text" id="table-width" value="100%" style="width:60px"></label><br><br>\n    <label>Cell Padding: <input type="number" id="table-padding" value="6" min="0" style="width:40px"></label>&nbsp;\n    <label>BG Color: <input type="color" id="table-bg" value="#ffffff"></label><br><br>\n    <button id="table-insert-btn">Insert Table</button>\n    <button id="table-cancel-btn">Cancel</button>\n  ',document.body.appendChild(t),document.getElementById("table-cancel-btn").onclick=()=>t.remove(),document.getElementById("table-insert-btn").onclick=()=>{const n=parseInt(document.getElementById("table-rows").value,10),o=parseInt(document.getElementById("table-cols").value,10),i=parseInt(document.getElementById("table-border").value,10),l=document.getElementById("table-width").value,s=parseInt(document.getElementById("table-padding").value,10),r=document.getElementById("table-bg").value;if(n>0&&o>0){let t=`<table style="border-collapse:collapse;width:${l};">`;for(let e=0;e<n;e++){t+="<tr>";for(let e=0;e<o;e++)t+=`<td style="border:${i}px solid #888;padding:${s}px;background:${r};">&nbsp;</td>`;t+="</tr>"}t+="</table><br>",e.focus(),document.execCommand("insertHTML",!1,t)}t.remove()}}function m(e,t,n,{showEmojiPicker:m}){e.innerHTML="",buttons.forEach(n=>{if("divider"===n.type){const t=document.createElement("span");t.className="toolbar-divider",t.innerHTML="&nbsp;|&nbsp;",e.appendChild(t)}else if("input"===n.type){const o=document.createElement("input");o.type="number",o.placeholder="Font Size",o.title=n.title,o.style.width="60px",o.min=1,o.max=99,o.id=n.name,o.onchange=function(e){t.focus(),o.value&&(f(t,o.value),t.focus())},e.appendChild(o)}else if("dropdown"===n.type){const o=document.createElement("select");o.title=n.title,o.id=n.name,n.options.forEach(e=>{const t=document.createElement("option");t.value=e.value,t.textContent=e.label,o.appendChild(t)}),o.onchange=function(e,t){return function(n){const o=p();e.focus(),"fontName"===t.name?(h(o),document.execCommand("fontName",!1,this.value)):"fontSize"===t.name?o?(h(o),f(e,this.value)):f(e,this.value):"lineHeight"===t.name&&(h(o),s(e,this.value)),setTimeout(()=>e.focus(),10)}}(t,n),o.addEventListener("mousedown",e=>{e.stopPropagation(),p()}),o.addEventListener("click",e=>e.stopPropagation()),e.appendChild(o)}else if("color"===n.type){const o=document.createElement("input");o.type="color",o.title=n.title,o.onchange=function(){document.execCommand(n.name,!1,this.value),t.focus()},e.appendChild(o)}else{const s=document.createElement("button");s.innerHTML=n.icon,s.title=n.title,s.type="button",s.onclick=function(){if("emoji"===n.cmd)m(t,e=>{document.execCommand("insertText",!1,e)});else if("createLink"===n.cmd){const e=prompt("Enter the link URL:","https://");e&&document.execCommand("createLink",!1,e)}else if("imageUpload"===n.cmd){const e=document.createElement("input");e.type="file",e.accept="image/*",e.style.display="none",e.onchange=function(t){const n=e.files[0];if(n){const e=new FileReader;e.onload=function(e){document.execCommand("insertImage",!1,e.target.result)},e.readAsDataURL(n)}},document.body.appendChild(e),e.click(),setTimeout(()=>e.remove(),1e3)}else if("imageByLink"===n.cmd){const e=prompt("Enter image URL:");e&&document.execCommand("insertImage",!1,e)}else if("insertTable"===n.cmd)a(t);else if("insertCodeBlock"===n.cmd)o(t);else if("insertHorizontalRule"===n.cmd)l(t);else if("insertPageBreak"===n.cmd)d(t);else if("insertDivider"===n.cmd)l(t,!0);else if("specialChar"===n.cmd)c(0,e=>{document.execCommand("insertText",!1,e)});else if("findReplace"===n.cmd)i(t);else if("mergeField"===n.cmd)r(t);else if("toggleMarkup"===n.cmd)!function(e,t){let n=document.getElementById("editor-markup");n?"none"===n.style.display?(n.value=t.innerHTML,n.style.display="block",t.style.display="none",n.focus()):(t.innerHTML=n.value,n.style.display="none",t.style.display="block",t.focus()):(n=document.createElement("textarea"),n.id="editor-markup",n.className="editor",n.style.display="block",n.style.minHeight="320px",n.style.width="100%",n.style.fontFamily="monospace",n.style.fontSize="15px",n.value=t.innerHTML,t.style.display="none",t.parentNode.appendChild(n),n.focus(),n.addEventListener("blur",function(){"none"!==n.style.display&&(t.innerHTML=n.value)}))}(0,t);else if("exportPDF"===n.cmd){const e=window.open("","","width=800,height=600");e.document.write("<html><head><title>Export PDF</title>"),e.document.write('<link rel="stylesheet" href="editor.css">'),e.document.write("</head><body>"+t.innerHTML+"</body></html>"),e.document.close(),e.focus(),setTimeout(()=>e.print(),500)}else if("downloadWord"===n.cmd){const e=t.innerHTML,n=new Blob(['<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">\n<head><meta charset="utf-8"></head><body>'+e+"</body></html>"],{type:"application/msword"}),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download="document.doc",o.click()}else if("importWord"===n.cmd){const e=document.createElement("input");e.type="file",e.accept=".doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",e.style.display="none",e.onchange=function(t){const n=e.files[0];if(n){const e=new FileReader;e.onload=function(e){let t=e.target.result;if(n.name.endsWith(".docx")){const e=t.match(/<w:t[^>]*>(.*?)<\/w:t>/g);e?(t=e.map(e=>e.replace(/<[^>]+>/g,"")),t=t.join(" ")):t="[Unable to extract text from .docx]"}else t=t.replace(/\0/g,"");document.execCommand("insertText",!1,t)},e.readAsText(n)}},document.body.appendChild(e),e.click(),setTimeout(()=>e.remove(),1e3)}else if("downloadHTML"===n.cmd){const e=t.innerHTML,n=new Blob(['<!DOCTYPE html><html><head><meta charset="utf-8"></head><body>'+e+"</body></html>"],{type:"text/html"}),o=document.createElement("a");o.href=URL.createObjectURL(n),o.download="document.html",o.click()}else"selectAll"===n.cmd?document.execCommand("selectAll",!1,null):"formatBlock"===n.cmd?(document.execCommand("formatBlock",!1,n.arg||null),function(e){const t=e.querySelectorAll("h1, h2, h3, p");t.forEach(e=>{switch(e.tagName){case"H1":e.style.fontSize="32px",e.style.fontWeight="600",e.style.margin="0";break;case"H2":e.style.fontSize="24px",e.style.fontWeight="600",e.style.margin="0";break;case"H3":e.style.fontSize="20.8px",e.style.fontWeight="600",e.style.margin="0";break;case"P":e.style.fontSize="17px",e.style.fontWeight="normal",e.style.margin="0"}})}(t)):document.execCommand(n.cmd,!1,n.arg||null);t.focus()},e.appendChild(s)}}),t.addEventListener("mouseup",p),t.addEventListener("keyup",p),t.addEventListener("focus",p)}n.d(t,{default:()=>x});let u=null;function p(){const e=window.getSelection();return e.rangeCount>0?(u=e.getRangeAt(0).cloneRange(),u):null}function h(e){if(e){const t=window.getSelection();t.removeAllRanges();try{t.addRange(e)}catch(e){}}}function f(e,t){const n=window.getSelection();if(0===n.rangeCount||n.isCollapsed){if(n.rangeCount>0){const o=n.getRangeAt(0),i=o.startContainer.nodeType===Node.TEXT_NODE?o.startContainer.parentElement:o.startContainer;i===e?e.style.fontSize=t+"px":i.style.fontSize=t+"px"}else e.style.fontSize=t+"px";return}const o=n.getRangeAt(0);if(!o.collapsed){!function(e){const t=document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return"SPAN"===t.tagName&&t.style.fontSize&&e.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),n=[];let o;for(;o=t.nextNode();)n.push(o);n.forEach(t=>{if(e.intersectsNode(t)){const e=t.parentNode;for(;t.firstChild;)e.insertBefore(t.firstChild,t);e.removeChild(t)}})}(o);const i=document.createElement("span");i.style.fontSize=t+"px";try{if(o.startContainer===o.endContainer)o.surroundContents(i);else{const e=o.extractContents();i.appendChild(e),o.insertNode(i)}o.selectNodeContents(i),n.removeAllRanges(),n.addRange(o)}catch(n){document.execCommand("styleWithCSS",!1,!0),document.execCommand("fontSize",!1,"7"),setTimeout(()=>{e.querySelectorAll('font[size="7"]').forEach(e=>{const n=document.createElement("span");n.style.fontSize=t+"px",n.innerHTML=e.innerHTML,e.parentNode.replaceChild(n,e)})},10)}}}function b(e,t){let n=document.getElementById("emoji-picker");n&&n.remove(),n=document.createElement("div"),n.id="emoji-picker",n.style.position="absolute",n.style.background="#fff",n.style.border="1px solid #ccc",n.style.padding="5px",n.style.zIndex=1e3,["üòÄ","üòÅ","üòÇ","ü§£","üòÉ","üòÑ","üòÖ","üòÜ","üòâ","üòä","üòç","üòò","üòú","ü§î","üòé","üò≠","üò°","üëç","üôè","üéâ","üî•","üíØ"].forEach(e=>{const o=document.createElement("button");o.textContent=e,o.style.fontSize="20px",o.onclick=function(){t(e),n.remove()},n.appendChild(o)}),document.body.appendChild(n);const o=e.getBoundingClientRect();n.style.left=o.left+"px",n.style.top=o.bottom+5+"px",setTimeout(()=>{document.addEventListener("mousedown",function e(t){n&&!n.contains(t.target)&&(n.remove(),document.removeEventListener("mousedown",e))})},10)}function y(e,t){try{return document.execCommand(e,!1,t||null)}catch(e){return!1}}function g(e){const t=prompt("Enter image URL:");t&&(document.execCommand("insertImage",!1,t),e.focus())}e=n.hmd(e);class E{constructor(e,t={}){if(this.elementId=e,this.element="string"==typeof e?document.getElementById(e):e,this.options={height:"400px",theme:"default",placeholder:"Start typing...",toolbar:!0,modules:{codeBlock:!0,findReplace:!0,table:!0,emoji:!0,horizontalLine:!0,imageByLink:!0,lineHeight:!0,mergeFields:!0,pageBreak:!0,specialChar:!0},onChange:null,onFocus:null,onBlur:null,onSelectionChange:null,...t},!this.element)throw new Error(`Element with ID "${e}" not found`);this.modules={},this.toolbar=null,this.editorElement=null,this.toolbarElement=null,this.init()}init(){const e=function(e){let t="string"==typeof e?document.querySelector(e):e;if(!t)throw new Error("Editor root element not found");let n=null;if(t.tagName&&"textarea"===t.tagName.toLowerCase()){n=t,t=document.createElement("div"),n.parentNode.insertBefore(t,n);const e=document.createElement("div");e.className="editor-toolbar",e.id="editor-toolbar";const o=document.createElement("div");return o.className="editor",o.id="editor",o.contentEditable="true",o.innerHTML=n.value,t.appendChild(e),t.appendChild(o),n.style.display="none",m(e,o,0,{showEmojiPicker:b}),o.addEventListener("click",()=>o.focus()),o.addEventListener("input",()=>{n.value=o.innerHTML}),{toolbar:e,editor:o,textarea:n,focus:()=>o.focus(),getHTML:()=>o.innerHTML,setHTML:e=>{o.innerHTML=e,n.value=e}}}{const e=document.createElement("div");e.className="editor-toolbar",e.id="editor-toolbar";const n=document.createElement("div");return n.className="editor",n.id="editor",n.contentEditable="true",t.appendChild(e),t.appendChild(n),m(e,n,0,{showEmojiPicker:b}),n.addEventListener("click",()=>n.focus()),{toolbar:e,editor:n,focus:()=>n.focus(),getHTML:()=>n.innerHTML,setHTML:e=>n.innerHTML=e}}}(this.element,this.options);this.editorElement=e.editor,this.toolbarElement=e.toolbar,this.initializeModules(),this.setupEventListeners(),this.applyTheme()}initializeModules(){const e=this.options.modules;e.codeBlock&&(this.modules.codeBlock=new o(this)),e.findReplace&&(this.modules.findReplace=new i(this)),e.table&&(this.modules.table=new a(this)),e.horizontalLine&&(this.modules.horizontalLine=new l(this)),e.imageByLink&&(this.modules.imageByLink=new g(this)),e.lineHeight&&(this.modules.lineHeight=new s(this)),e.mergeFields&&(this.modules.mergeFields=new r(this)),e.pageBreak&&(this.modules.pageBreak=new d(this)),e.specialChar&&(this.modules.specialChar=new c(this))}setupEventListeners(){this.editorElement&&(this.editorElement.addEventListener("input",()=>{this.options.onChange&&this.options.onChange(this.getContent())}),this.editorElement.addEventListener("focus",()=>{this.options.onFocus&&this.options.onFocus()}),this.editorElement.addEventListener("blur",()=>{this.options.onBlur&&this.options.onBlur()}),document.addEventListener("selectionchange",()=>{this.options.onSelectionChange&&document.activeElement===this.editorElement&&this.options.onSelectionChange(window.getSelection())}))}applyTheme(){this.options.theme&&this.element&&this.element.classList.add(`editor-theme-${this.options.theme}`),this.options.height&&this.editorElement&&(this.editorElement.style.minHeight=this.options.height),this.options.placeholder&&this.editorElement&&this.editorElement.setAttribute("data-placeholder",this.options.placeholder)}getContent(){return this.editorElement?this.editorElement.innerHTML:""}setContent(e){this.editorElement&&(this.editorElement.innerHTML=e,this.options.onChange&&this.options.onChange(e))}focus(){this.editorElement&&this.editorElement.focus()}disable(){this.editorElement&&(this.editorElement.contentEditable=!1,this.editorElement.classList.add("editor-disabled")),this.toolbarElement&&this.toolbarElement.classList.add("toolbar-disabled")}enable(){this.editorElement&&(this.editorElement.contentEditable=!0,this.editorElement.classList.remove("editor-disabled")),this.toolbarElement&&this.toolbarElement.classList.remove("toolbar-disabled")}execCommand(e,t){y(e,t),this.focus()}undo(){this.execCommand("undo")}redo(){this.execCommand("redo")}destroy(){this.editorElement&&(this.editorElement.removeEventListener("input",()=>{}),this.editorElement.removeEventListener("focus",()=>{}),this.editorElement.removeEventListener("blur",()=>{})),Object.keys(this.modules).forEach(e=>{this.modules[e]&&"function"==typeof this.modules[e].destroy&&this.modules[e].destroy()}),this.element&&(this.element.innerHTML="",this.element.classList.remove(`editor-theme-${this.options.theme}`)),this.modules={},this.editorElement=null,this.toolbarElement=null}insertHTML(e){this.execCommand("insertHTML",e)}getSelection(){return window.getSelection()}saveSelection(){const e=this.getSelection();return e.rangeCount>0?e.getRangeAt(0).cloneRange():null}restoreSelection(e){if(e){const t=this.getSelection();t.removeAllRanges();try{t.addRange(e)}catch(e){}}}}e.exports?e.exports=E:"function"==typeof define&&n.amdO?define(function(){return E}):window.MineEditor=E;const x=E}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var l=t[o]={id:o,loaded:!1,exports:{}};return e[o](l,l.exports,n),l.loaded=!0,l.exports}n.amdO={},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o=n(71);return o=o.default})());